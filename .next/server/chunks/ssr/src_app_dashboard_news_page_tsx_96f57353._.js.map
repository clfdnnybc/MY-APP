{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///Users/57block/my-app/src/app/dashboard/news/page.tsx"],"sourcesContent":["'use client';\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useTranslation } from 'react-i18next';\nimport { useRouter } from 'next/navigation';\nimport { useUsername } from \"@/app/UsernameContext\";\n\ninterface NewsItem {\n  id: number;\n  title: string;\n  content: string;\n  date: string;\n  published: boolean;\n  username: string;\n  avatar: string;\n}\n\nexport default function NewsManagementPage() {\n  const { t } = useTranslation();\n  const router = useRouter();\n  const [news, setNews] = useState<NewsItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const { username } = useUsername();\n\n  useEffect(() => {\n    const fetchNews = async () => {\n      try {\n        const response = await fetch(`/api/news/management?u=${username}`);\n        if (!response.ok) throw new Error('Failed to fetch news');\n        \n        \n        const data = await response.json();\n        setNews(data);\n        setError(null);\n      } catch (err) {\n        console.error('Fetch error:', err);\n        setError(err instanceof Error ? err.message : 'Unknown error');\n        setNews([]);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchNews();\n  }, []);\n\n  const handleDelete = async (id: number) => {\n    try {\n      const response = await fetch(`/api/news/${id}`, {\n        method: 'DELETE'\n      });\n      \n      if (!response.ok) throw new Error('Failed to delete news');\n      \n      setNews(news.filter(item => item.id !== id));\n    } catch (err) {\n      console.error('Delete error:', err);\n      alert(err instanceof Error ? err.message : 'Delete failed');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"p-6 max-w-6xl mx-auto\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mb-8\"></div>\n          <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden\">\n            <table className=\"w-full\">\n              <thead className=\"bg-gray-50 dark:bg-gray-900\">\n                <tr>\n                  {['标题', '状态', '日期', '操作'].map((_, i) => (\n                    <th key={i} className=\"px-6 py-3 h-12 bg-gray-200 dark:bg-gray-700 rounded\"></th>\n                  ))}\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700\">\n                {[...Array(5)].map((_, i) => (\n                  <tr key={i} className=\"h-16\">\n                    {[...Array(4)].map((_, j) => (\n                      <td key={j} className=\"px-6 py-4\">\n                        <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4\"></div>\n                      </td>\n                    ))}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-6 max-w-6xl mx-auto\">\n        <div className=\"bg-red-100 dark:bg-red-900/20 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded relative mb-6\">\n          {t('fetchError')}: {error}\n        </div>\n        <button \n          onClick={() => window.location.reload()}\n          className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg\"\n        >\n          {t('retry')}\n        </button>\n      </div>\n    );\n  }\n  if (news.length === 0) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-md p-8 text-center\">\n          <div className=\"text-5xl mb-4\">📰</div>\n          <h3 className=\"text-lg font-medium text-gray-800 dark:text-gray-200 mb-2\">\n            {t('noNewsTitle')}\n          </h3>\n          <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\n            {t('noNewsDescription')}\n          </p>\n          <Link href=\"/dashboard/news/edit\">\n            <button className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg\">\n              {t('createFirstNews')}\n            </button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 max-w-6xl mx-auto\">\n      <div className=\"flex justify-between items-center mb-8\">\n        <h1 className=\"text-2xl font-bold text-gray-800 dark:text-gray-200\">\n          {t('newsManagement')}\n        </h1>\n        <Link href=\"/dashboard/news/edit\">\n          <button className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center\">\n            <span className=\"icon-[mynaui--plus] mr-2 w-5 h-5\"></span>\n            {t('addNews')}\n          </button>\n        </Link>\n      </div>\n\n      <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden\">\n        <table className=\"w-full\">\n          <thead className=\"bg-gray-50 dark:bg-gray-900\">\n            <tr>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                {t('title')}\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                {t('status')}\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                {t('date')}\n              </th>\n              <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                {t('actions')}\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700\">\n            {news.map(item => (\n              \n              <tr key={item.id} className=\"hover:bg-gray-50 dark:hover:bg-gray-900\">\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <div className=\"text-sm font-medium text-gray-900 dark:text-gray-200\">\n                    {item.title}\n                  </div>\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                    item.published \n                      ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                      : 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'\n                  }`}>\n                    {item.published ? t('published') : t('draft')}\n                  </span>\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                  {new Date(item.date).toLocaleDateString()}\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2\">\n                  <button\n                    onClick={() => router.push(`/dashboard/news/${item.id}`)}\n                    className=\"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300\"\n                  >\n                    {t('view')}\n                  </button>\n                  <button\n                    onClick={() => router.push(`/dashboard/news/edit?id=${item.id}`)}\n                    className=\"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300\"\n                  >\n                    {t('edit')}\n                  </button>\n                  <button\n                    onClick={() => handleDelete(item.id)}\n                    className=\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300\"\n                  >\n                    {t('delete')}\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n\n        {news.length === 0 && (\n          <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n            {t('noNews')}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}