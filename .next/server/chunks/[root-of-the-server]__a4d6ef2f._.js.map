{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///Users/57block/my-app/src/app/api/account/password/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport mysql from \"mysql2/promise\";\nimport bcrypt from \"bcryptjs\";\n\nconst pool = mysql.createPool({\n  host: \"localhost\",\n  user: \"root\",\n  password: \"\",\n  database: \"userinfo\",\n  waitForConnections: true,\n  connectionLimit: 10,\n});\n\nexport async function PUT(req: NextRequest) {\n  const { oldPassword, newPassword, storedUsername } = await req.json(); // 接收 storedUsername\n  const [rows] = await pool.query(\"SELECT * FROM users WHERE username = ?\", [storedUsername]);\n  const user = (rows as any[])[0];\n\n  if (!user || !(await bcrypt.compare(oldPassword, user.password)))\n    return NextResponse.json({ message: \"Invalid credentials\" }, { status: 401 });\n\n  try {\n    const hashedPassword = await bcrypt.hash(newPassword, 12);\n    await pool.query(\"UPDATE users SET password = ? WHERE username = ?\", [hashedPassword, storedUsername]);\n    return NextResponse.json({ message: \"Password updated successfully\" });\n  } catch (error) {\n    return NextResponse.json({ message: \"Failed to update password\" }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;AAAA;AACA;AACA;;;;AAEA,MAAM,OAAO,mIAAA,CAAA,UAAK,CAAC,UAAU,CAAC;IAC5B,MAAM;IACN,MAAM;IACN,UAAU;IACV,UAAU;IACV,oBAAoB;IACpB,iBAAiB;AACnB;AAEO,eAAe,IAAI,GAAgB;IACxC,MAAM,EAAE,WAAW,EAAE,WAAW,EAAE,cAAc,EAAE,GAAG,MAAM,IAAI,IAAI,IAAI,oBAAoB;IAC3F,MAAM,CAAC,KAAK,GAAG,MAAM,KAAK,KAAK,CAAC,0CAA0C;QAAC;KAAe;IAC1F,MAAM,OAAO,AAAC,IAAc,CAAC,EAAE;IAE/B,IAAI,CAAC,QAAQ,CAAE,MAAM,mIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,aAAa,KAAK,QAAQ,GAC5D,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QAAE,SAAS;IAAsB,GAAG;QAAE,QAAQ;IAAI;IAE7E,IAAI;QACF,MAAM,iBAAiB,MAAM,mIAAA,CAAA,UAAM,CAAC,IAAI,CAAC,aAAa;QACtD,MAAM,KAAK,KAAK,CAAC,oDAAoD;YAAC;YAAgB;SAAe;QACrG,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAgC;IACtE,EAAE,OAAO,OAAO;QACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACnF;AACF","debugId":null}}]
}