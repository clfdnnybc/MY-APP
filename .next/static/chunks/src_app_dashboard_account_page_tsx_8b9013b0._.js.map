{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/57block/my-app/src/app/dashboard/account/page.tsx"],"sourcesContent":["// app/dashboard/account/page.tsx\n\"use client\";\nimport { useState } from \"react\";\nimport { useUsername } from \"../../UsernameContext\";\nimport { useTranslation } from \"react-i18next\";\n\nexport default function AccountPage() {\n  const { username, setUsername } = useUsername();\n  const { avatar, setAvatar } = useUsername();\n  const [showUsernameForm, setShowUsernameForm] = useState(false);\n  const [showPasswordForm, setShowPasswordForm] = useState(false);\n  const [showAvatarForm, setShowAvatarForm] = useState(false);\n  const [newUsername, setNewUsername] = useState(\"\");\n  const [oldPassword, setOldPassword] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [selectedAvatar, setSelectedAvatar] = useState<string | null>(null);\n  const [message, setMessage] = useState(\"\");\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const { t } = useTranslation();\n\n  const closeAllForms = () => {\n    setShowUsernameForm(false);\n    setShowPasswordForm(false);\n    setShowAvatarForm(false);\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    switch (name) {\n      case \"newUsername\":\n        setNewUsername(value);\n        break;\n      case \"oldPassword\":\n        setOldPassword(value);\n        break;\n      case \"newPassword\":\n        setNewPassword(value);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const handleUsernameSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSubmitting(true);\n    setMessage(\"\");\n    try {\n      const res = await fetch(\"/api/account/username\", {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ username: newUsername, storedUsername: username }),\n      });\n      const json = await res.json();\n      if (!res.ok) throw new Error(json.message);\n      setMessage(json.message);\n      setUsername(newUsername);\n      localStorage.setItem(\"username\", newUsername);\n      closeAllForms();\n    } catch (err: unknown) {\n      setMessage(err instanceof Error ? err.message : \"Unknown error\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handlePasswordSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSubmitting(true);\n    setMessage(\"\");\n    try {\n      const res = await fetch(\"/api/account/password\", {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ oldPassword, newPassword, storedUsername: username }),\n      });\n      const json = await res.json();\n      if (!res.ok) throw new Error(json.message);\n      setMessage(json.message);\n      closeAllForms();\n    } catch (err: unknown) {\n      setMessage(err instanceof Error ? err.message : \"Unknown error\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleAvatarSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSubmitting(true);\n    setMessage(\"\");\n    try {\n      const res = await fetch(\"/api/account/avatar\", {\n        method: \"PUT\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ username, avatar: selectedAvatar }),\n      });\n      const json = await res.json();\n      if (!res.ok) throw new Error(json.message);\n      setMessage(json.message);\n      if (selectedAvatar) setAvatar(selectedAvatar);\n      closeAllForms();\n    } catch (err: unknown) {\n      setMessage(err instanceof Error ? err.message : \"Unknown error\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const UpdateButton = ({ onClick, text }: { onClick: (e: React.FormEvent) => void | Promise<void>; text: string }) => (\n    <button\n      onClick={onClick}\n      type=\"submit\"\n      className={`w-full px-4 py-2 rounded-lg text-white transition-colors\n                ${isSubmitting ? \"bg-gray-400 cursor-not-allowed\" : \"bg-blue-500 hover:bg-blue-600\"}`}\n      disabled={isSubmitting}\n    >\n      {text}\n    </button>\n  );\n\n  return (\n    <div className=\"bg-white dark:bg-gray-900 dark:text-white p-8 rounded-lg shadow-md w-full max-w-md mx-auto\">\n      <h1 className=\"text-2xl font-semibold text-gray-800 dark:text-gray-200 mb-6\">{t(\"accountSettings\")}</h1>\n\n      <div className=\"mb-6 text-center\">\n        <img src={avatar|| \"/avatar.ico\" } alt=\"avatar\" className=\"w-32 h-32 rounded-full mx-auto\" />\n        <p className=\"text-gray-700 dark:text-gray-200 text-center mt-2\">{username}</p>\n      </div>\n\n      {/* Avatar Section */}\n      <div className=\"space-y-3 mt-8\">\n        <div className=\"flex justify-between items-center\">\n          <h2 className=\"text-lg font-medium text-gray-700 dark:text-gray-100\">{t(\"avatar\")}</h2>\n          <button\n            onClick={() => setShowAvatarForm(!showAvatarForm)}\n            className=\"px-3 py-1 text-sm rounded text-white bg-blue-500 hover:bg-blue-600\"\n          >\n            {showAvatarForm ? t(\"cancel\") : t(\"edit\")}\n          </button>\n        </div>\n\n        <div\n          className={`transition-[max-height,opacity] duration-300 ease-in-out overflow-hidden\n                    ${showAvatarForm ? \"max-h-60 opacity-100\" : \"max-h-0 opacity-0\"}`}\n        >\n          <form onSubmit={handleAvatarSubmit} className=\"space-y-2\">\n            <div className=\"flex flex-wrap gap-4 justify-center\">\n              {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((i) => (\n                <img\n                  key={i}\n                  src={`/identicon${i}.png`}\n                  alt={`avatar${i}`}\n                  className={`w-16 h-16 rounded-full cursor-pointer ${\n                    selectedAvatar === `/identicon${i}.png` ? \"border-2 border-blue-500\" : \"\"\n                  }`}\n                  onClick={() => setSelectedAvatar(`/identicon${i}.png`)}\n                />\n              ))}\n            </div>\n            <UpdateButton onClick={handleAvatarSubmit} text={t(\"updateAvatar\")} />\n          </form>\n        </div>\n        {!showAvatarForm && (\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">{t(\"editAvatarTip\")}</p>\n        )}\n      </div>\n\n      {/* Username Section */}\n      <div className=\"space-y-3 mt-8\">\n        <div className=\"flex justify-between items-center\">\n          <h2 className=\"text-lg font-medium text-gray-700 dark:text-gray-100\">{t(\"username\")}</h2>\n          <button\n            onClick={() => {\n              if (!showUsernameForm) setNewUsername(username);\n              setShowUsernameForm(!showUsernameForm);\n            }}\n            className=\"px-3 py-1 text-sm rounded text-white bg-blue-500 hover:bg-blue-600\"\n          >\n            {showUsernameForm ? t(\"cancel\") : t(\"edit\")}\n          </button>\n        </div>\n\n        <div\n          className={`transition-[max-height,opacity] duration-300 ease-in-out overflow-hidden\n                    ${showUsernameForm ? \"max-h-40 opacity-100\" : \"max-h-0 opacity-0\"}`}\n        >\n          <form onSubmit={handleUsernameSubmit} className=\"space-y-2\">\n            <input\n              type=\"text\"\n              name=\"newUsername\"\n              value={newUsername}\n              onChange={handleChange}\n              className=\"w-full p-3 border rounded focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500\"\n            />\n            <UpdateButton onClick={handleUsernameSubmit} text={t(\"updateUsername\")} />\n          </form>\n        </div>\n\n        {!showUsernameForm && (\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">{t(\"editUsernameTip\")}</p>\n        )}\n      </div>\n\n      {/* Password Section */}\n      <div className=\"space-y-3 mt-8\">\n        <div className=\"flex justify-between items-center\">\n          <h2 className=\"text-lg font-medium text-gray-700 dark:text-gray-100\">{t(\"password\")}</h2>\n          <button\n            onClick={() => setShowPasswordForm(!showPasswordForm)}\n            className=\"px-3 py-1 text-sm rounded text-white bg-blue-500 hover:bg-blue-600\"\n          >\n            {showPasswordForm ? t(\"cancel\") : t(\"edit\")}\n          </button>\n        </div>\n\n        <div\n          className={`transition-[max-height,opacity] duration-300 ease-in-out overflow-hidden\n                    ${showPasswordForm ? \"max-h-60 opacity-100\" : \"max-h-0 opacity-0\"}`}\n        >\n          <form onSubmit={handlePasswordSubmit} className=\"space-y-2\">\n            <input\n              type=\"password\"\n              name=\"oldPassword\"\n              value={oldPassword}\n              onChange={handleChange}\n              placeholder={t(\"currentPassword\")}\n              className=\"w-full p-3 border rounded focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500\"\n            />\n            <input\n              type=\"password\"\n              name=\"newPassword\"\n              value={newPassword}\n              onChange={handleChange}\n              placeholder={t(\"newPassword\")}\n              className=\"w-full p-3 border rounded focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500\"\n            />\n            <UpdateButton onClick={handlePasswordSubmit} text={t(\"updatePassword\")} />\n          </form>\n        </div>\n\n        {!showPasswordForm && (\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">{t(\"editPasswordTip\")}</p>\n        )}\n      </div>\n\n      {message && (\n        <div className=\"mt-6 p-4 bg-blue-100 border border-blue-100 rounded-lg text-blue-800\">\n          {message}\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}